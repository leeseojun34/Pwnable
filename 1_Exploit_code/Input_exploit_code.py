from pwn import *

argvs = [str(i) for i in range(100)]
argvs[65] = "\x00"
argvs[66] = "\x20\x0a\x0d"
argvs[67] = "12345"

err = open('/tmp/poty/err', 'w')
err.write('\x00\x0a\x02\xff')
err = open('/tmp/poty/err', 'r')

stage4 = open('/tmp/poty/\x0a', 'w')
stage4.write('\x00\x00\x00\x00')
stage4 = open('/tmp/poty/\x0a', 'r')

payload = '\x00\x0a\x00\xff'
send_env = {"\xde\xad\xbe\xef" : "\xca\xfe\xba\xbe"}

p = process(executable='/home/input2/input', argv=argvs, stderr=err, env=send_env)
p.send(payload)


connect = remote('loclhost', '12345')
connect.send("\xde\xad\xbe\xef")

print(p.recvuntil('Stage 5 clear!\n'))

target.interactive()